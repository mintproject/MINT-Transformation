version: "1.0"
description: Data transformation to generate daily average data from original GLDAS data sources
inputs:
  gldas_dataset_id:
    comment: DataCatalog Dataset ID for GLDAS
    value: 5babae3f-c468-4e01-862e-8b201468e3b5
  agg_function:
    comment: Operation to be used for aggregation. Values can be ("sum", "average", "count")
    value: average
  agg_time_period:
    comment: Time period for aggregation. Values can be ("minute", "hour", "day", "month", "year")
    value: day
  start_time:
    comment: Start time to filter Resources for DataCatalog GLDAS Dataset (can also be "null" to leave this end open)
    value: '2011-01-01 00:00:00'
  end_time:
    comment: End time to filter Resources for DataCatalog GLDAS Dataset (can also be "null" to leave this end open)
    value: '2011-01-02 00:00:00'
  crop_region_xmin:
    comment: Target region bounding box xmin coordinate
    value: 32.75418
  crop_region_ymin:
    comment: Target region bounding box ymin coordinate
    value: 3.22206
  crop_region_xmax:
    comment: Target region bounding box xmax coordinate
    value: 47.98942
  crop_region_ymax:
    comment: Target region bounding box ymax coordinate
    value: 15.15943
  output_file:
    comment: Path to output compressed file
    value: output.zip
adapters:
  gldas_read_func:
    comment: My gldas read func adapter
    adapter: funcs.DcatReadFunc
    inputs:
      dataset_id: $$.gldas_dataset_id
      start_time: $$.start_time
      end_time: $$.end_time
  my_crop_wrapper:
    comment: My cropping func wrapper adapter
    adapter: funcs.CroppingTransFunc
    inputs:
      variable_name: $$.variable_name
      dataset: $.gldas_read_func.data
      xmin: $$.crop_region_xmin
      ymin: $$.crop_region_ymin
      xmax: $$.crop_region_xmax
      ymax: $$.crop_region_ymax
  geotiff_writer:
    adapter: funcs.GeoTiffWriteFunc
    inputs:
      dataset: $.weather_data.data
      variable_name: $$.variable_name
      output_dir: $$.tmp_dir_geotiff
